### Необходимые пояснения к скриптам, работающим с устройствами через ADB

Environment:
 - Android >=5
 - ADB
 - Android device drivers

#### adb_usb_restart
Рестарт ADB и выполняется одновременно для всей фермы девайсов, подключенных к данной машине, один раз за тест перед началом каких-либо взаимодействий с устройствами. Причины выбора данного режима работы:
 - если девайсов несколько, процессы на них могут быть рассинхронизированы (в более-менее продолжительных тестах), поэтому остановка ADB для рестарта одного устройства может прервать процесс взаимодействия работающих скриптов с другими устройствами;

#### run_android_test
Инсталляция приложения через adb в некоторых случаях (зависит от версии Android, прошивки, приложения) может формально заканчиваться со статусом Success, но при попытке немедленного запуска наблюдается падение либо некорректная работа приложения, т.е. в реальности какие-то background процессы инсталляции еще не завершились. Опытным путем найдены методы борьбы с данным явлением:
 - повторная инсталляция сразу после первой;
 - выдержка между окончанием инсталляции и запуском ( >=30 sec).

Оба метода используются в данном скрипте для повышения надежности инсталляции.

Для контроля экрана устройства (включение перед началом теста, выключение по окончании теста), используются команды вида
```
adb -s %device_code% shell "if [[ -z $(dumpsys power | grep 'Display Power: state'=ON) ]] && [[ -n $(dumpsys power | grep 'Display Power: state') ]]; then input keyevent 26; fi"
```
Они проверяют состояние дисплея и при необходимости производят программное нажатие кнопки power для входа в спящее состояние (или выхода из него). Такой вид команд актуален начиная с версии Android 5, для более ранних используются отличающиеся команды, исключенные из настоящего скрипта, поскольку устройств со старыми версиями Android в составе фермы нет.
